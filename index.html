<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aapki Khabar</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f4f4f4}
header{background:#d32f2f;color:#fff;padding:15px;text-align:center}
.lang-btns button{margin:5px;padding:8px 16px;border-radius:20px;border:none;cursor:pointer}
.lang-btns .active{background:#fff;color:#d32f2f}

.categories{display:flex;overflow-x:auto;padding:10px;background:#fff}
.categories button{flex:0 0 auto;margin-right:8px;padding:8px 14px;border-radius:20px;border:none;background:#eee}
.categories .active{background:#d32f2f;color:#fff}

#newsList{padding:12px}
.card{background:#fff;padding:15px;border-radius:10px;margin-bottom:15px;box-shadow:0 2px 5px rgba(0,0,0,.1)}
.card h2{margin:0 0 8px}
.meta{font-size:12px;color:#777;margin-top:8px}
.read-btn{margin-top:10px;padding:8px 12px;border:none;border-radius:6px;background:#d32f2f;color:#fff}
.full-content{display:none;margin-top:10px;color:#333}

.ad-box{background:#fff3cd;padding:15px;border-radius:8px;margin:15px 0;text-align:center;font-weight:bold}
</style>
</head>

<body>

<header>
  <h2>üóûÔ∏è Aapki Khabar</h2>
  <p>‡§∏‡§Æ‡§ù‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§ñ‡§¨‡§∞‡•á‡§Ç ¬∑ Easy to Understand News</p>
  <div class="lang-btns">
    <button onclick="setLang('hi')" id="btn-hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
    <button onclick="setLang('en')" id="btn-en" class="active">English</button>
  </div>
</header>

<div class="categories" id="catBar"></div>

<div id="newsList">Loading news‚Ä¶</div>

<script>
/* üî• FIREBASE CONFIG */
firebase.initializeApp({
  apiKey: "AIzaSyDyFelhS-cksx0vKkKwllROaf-qXXYoIDM",
  authDomain: "aapki-khabar-171e9.firebaseapp.com",
  projectId: "aapki-khabar-171e9"
});
const db = firebase.firestore();

/* STATE */
let currentLang = "en";
let currentCategory = "All";

/* CATEGORIES (LOCKED) */
const categories = [
  "All",
  "Finance",
  "Government",
  "World",
  "Court & Law",
  "Sports",
  "Climate"
];

/* INIT CATEGORY BAR */
const catBar = document.getElementById("catBar");
categories.forEach(cat=>{
  const b=document.createElement("button");
  b.innerText=cat;
  if(cat==="All") b.classList.add("active");
  b.onclick=()=>{
    document.querySelectorAll(".categories button").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    currentCategory=cat;
    loadNews();
  };
  catBar.appendChild(b);
});

/* LANGUAGE SWITCH */
function setLang(lang){
  currentLang=lang;
  document.getElementById("btn-hi").classList.toggle("active",lang==="hi");
  document.getElementById("btn-en").classList.toggle("active",lang==="en");
  loadNews();
}

/* LOAD NEWS */
function loadNews(){
  const container=document.getElementById("newsList");
  container.innerHTML="Loading news‚Ä¶";

  db.collection("news").orderBy("createdAt","desc").get()
  .then(snapshot=>{
    container.innerHTML="";
    let count=0,shown=0;

    snapshot.forEach(doc=>{
      const n=doc.data();

      if(currentCategory!=="All" && n.category!==currentCategory) return;

      const lang=n.language?.[currentLang];
      if(!lang) return;

      shown++;
      count++;

      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`
        <h2>${lang.headline}</h2>
        <p>${lang.summary}</p>
        <button class="read-btn">Read Full News</button>
        <div class="full-content">${lang.content}</div>
        <div class="meta">${n.category} ‚Ä¢ ${n.source}</div>
      `;

      const btn=card.querySelector(".read-btn");
      const full=card.querySelector(".full-content");
      btn.onclick=()=>full.style.display=full.style.display==="block"?"none":"block";

      container.appendChild(card);

      if(count%2===0){
        const ad=document.createElement("div");
        ad.className="ad-box";
        ad.innerText="Advertisement";
        container.appendChild(ad);
      }
    });

    if(shown===0){
      container.innerHTML="<p style='padding:15px'>No news available.</p>";
    }
  })
  .catch(()=>{
    container.innerHTML="Error loading news.";
  });
}

/* AUTO REFRESH ‚Äì 10 MIN */
loadNews();
setInterval(loadNews,600000);
</script>

</body>
</html>
